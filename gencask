#!/usr/bin/env sh
set -e

FILE=$1

TEST_DEP=
if [ "$FILE" = "--test" ]; then
    TEST_DEP=1
    FILE=$2
fi

if [ "$FILE" = "" ] || [ ! -e "$FILE" ]; then
    echo "Error: '$FILE' is not existed"
    exit 1
fi

cat << EOF > Cask
(source gnu)
(source melpa)

EOF

if [ "$FILE" != "" ]; then
    echo "(package-file \"$FILE\")" >> Cask
fi

if [ ! -z $TEST_DEP ]; then
    cat <<EOF >> Cask

(development
 (depends-on "ert"))
EOF
fi
